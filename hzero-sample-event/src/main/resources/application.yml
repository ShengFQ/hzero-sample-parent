spring:
  application:
    name: hzero-event-sample
  datasource:
    url: ${SPRING_DATASOURCE_URL:jdbc:mysql://db.hzero.org:3306/hzero_demo?useUnicode=true&characterEncoding=utf-8&useSSL=false}
    username: ${SPRING_DATASOURCE_USERNAME:hzero}
    password: ${SPRING_DATASOURCE_PASSWORD:hzero}
    hikari:
      # \u8FDE\u63A5\u6C60\u6700\u5C0F\u7A7A\u95F2\u8FDE\u63A5\u6570
      minimum-idle: ${SPRING_DATASOURCE_MINIMUM_IDLE:20}
      # \u8FDE\u63A5\u6C60\u5141\u8BB8\u7684\u6700\u5927\u8FDE\u63A5\u6570
      maximum-pool-size: ${SPRING_DATASOURCE_MAXIMUM_POOL_SIZE:200}
      # \u7B49\u5F85\u8FDE\u63A5\u6C60\u5206\u914D\u8FDE\u63A5\u7684\u6700\u5927\u65F6\u957F\uFF08\u6BEB\u79D2\uFF09
      connection-timeout: ${SPRING_DATASOURCE_CONNECTION_TIMEOUT:30000}
  redis:
    host: ${SPRING_REDIS_HOST:redis.hzero.org}
    port: ${SPRING_REDIS_PORT:6379}
    database: ${SPRING_REDIS_DATABASE:1}
    jedis:
      pool:
        # \u8D44\u6E90\u6C60\u4E2D\u6700\u5927\u8FDE\u63A5\u6570
        # \u9ED8\u8BA48\uFF0C-1\u8868\u793A\u65E0\u9650\u5236\uFF1B\u53EF\u6839\u636E\u670D\u52A1\u5E76\u53D1redis\u60C5\u51B5\u53CA\u670D\u52A1\u7AEF\u7684\u652F\u6301\u4E0A\u9650\u8C03\u6574
        max-active: ${SPRING_REDIS_POOL_MAX_ACTIVE:50}
        # \u8D44\u6E90\u6C60\u8FD0\u884C\u6700\u5927\u7A7A\u95F2\u7684\u8FDE\u63A5\u6570
        # \u9ED8\u8BA48\uFF0C-1\u8868\u793A\u65E0\u9650\u5236\uFF1B\u53EF\u6839\u636E\u670D\u52A1\u5E76\u53D1redis\u60C5\u51B5\u53CA\u670D\u52A1\u7AEF\u7684\u652F\u6301\u4E0A\u9650\u8C03\u6574\uFF0C\u4E00\u822C\u5EFA\u8BAE\u548Cmax-active\u4FDD\u6301\u4E00\u81F4\uFF0C\u907F\u514D\u8D44\u6E90\u4F38\u7F29\u5E26\u6765\u7684\u5F00\u9500
        max-idle: ${SPRING_REDIS_POOL_MAX_IDLE:50}
        # \u5F53\u8D44\u6E90\u6C60\u8FDE\u63A5\u7528\u5C3D\u540E\uFF0C\u8C03\u7528\u8005\u7684\u6700\u5927\u7B49\u5F85\u65F6\u95F4(\u5355\u4F4D\u4E3A\u6BEB\u79D2)
        # \u9ED8\u8BA4 -1 \u8868\u793A\u6C38\u4E0D\u8D85\u65F6\uFF0C\u8BBE\u7F6E5\u79D2
        max-wait: ${SPRING_REDIS_POOL_MAX_WAIT:5000}

server:
  undertow:
    # \u8BBE\u7F6EIO\u7EBF\u7A0B\u6570, \u5B83\u4E3B\u8981\u6267\u884C\u975E\u963B\u585E\u7684\u4EFB\u52A1,\u5B83\u4EEC\u4F1A\u8D1F\u8D23\u591A\u4E2A\u8FDE\u63A5
    # \u9ED8\u8BA4\u503C\u4E3A8\uFF0C\u5EFA\u8BAE\u8BBE\u7F6E\u6BCF\u4E2ACPU\u6838\u5FC3\u4E00\u4E2A\u7EBF\u7A0B
    io-threads: ${SERVER_UNDERTOW_IO_THREADS:4}
    # \u963B\u585E\u4EFB\u52A1\u7EBF\u7A0B\u6C60, \u5F53\u6267\u884C\u7C7B\u4F3Cservlet\u8BF7\u6C42\u963B\u585E\u64CD\u4F5C, undertow\u4F1A\u4ECE\u8FD9\u4E2A\u7EBF\u7A0B\u6C60\u4E2D\u53D6\u5F97\u7EBF\u7A0B
    # \u9ED8\u8BA4\u7B49\u4E8E io-threads*8\uFF0C\u5B83\u7684\u503C\u8BBE\u7F6E\u53D6\u51B3\u4E8E\u7CFB\u7EDF\u7684\u8D1F\u8F7D\uFF0C\u53EF\u9002\u5F53\u8C03\u5927\u8BE5\u503C
    worker-threads: ${SERVER_UNDERTOW_WORKER_THREADS:128}
    # \u6BCF\u5757buffer\u7684\u7A7A\u95F4\u5927\u5C0F\uFF0C\u8D8A\u5C0F\u7A7A\u95F4\u88AB\u5229\u7528\u8D8A\u5145\u5206
    # \u4E0D\u8981\u8BBE\u7F6E\u592A\u5927\uFF0C\u4EE5\u514D\u5F71\u54CD\u5176\u4ED6\u5E94\u7528\uFF0C\u5408\u9002\u5373\u53EF
    buffer-size: ${SERVER_UNDERTOW_BUFFER_SIZE:1024}
    # \u662F\u5426\u5206\u914D\u7684\u76F4\u63A5\u5185\u5B58(NIO\u76F4\u63A5\u5206\u914D\u7684\u5806\u5916\u5185\u5B58)
    # \u9ED8\u8BA4false
    direct-buffers: true
    # HTTP POST\u8BF7\u6C42\u6700\u5927\u7684\u5927\u5C0F
    # \u9ED8\u8BA40\uFF0C\u65E0\u9650\u5236\uFF0C\u53EF\u8BBE\u7F6E10M
    max-http-post-size: 10485760

feign:
  hystrix:
    enabled: true

hystrix:
  threadpool:
    default:
      # \u6267\u884C\u547D\u4EE4\u7EBF\u7A0B\u6C60\u7684\u6838\u5FC3\u7EBF\u7A0B\u6570\uFF0C\u4E5F\u662F\u547D\u4EE4\u6267\u884C\u7684\u6700\u5927\u5E76\u53D1\u91CF
      # \u9ED8\u8BA410
      coreSize: 1000
      # \u6700\u5927\u6267\u884C\u7EBF\u7A0B\u6570
      maximumSize: 1000
  command:
    default:
      execution:
        isolation:
          thread:
            # HystrixCommand \u6267\u884C\u7684\u8D85\u65F6\u65F6\u95F4\uFF0C\u8D85\u65F6\u540E\u8FDB\u5165\u964D\u7EA7\u5904\u7406\u903B\u8F91\u3002\u4E00\u4E2A\u63A5\u53E3\uFF0C\u7406\u8BBA\u7684\u6700\u4F73\u54CD\u5E94\u901F\u5EA6\u5E94\u8BE5\u5728200ms\u4EE5\u5185\uFF0C\u6216\u8005\u6162\u70B9\u7684\u63A5\u53E3\u5C31\u51E0\u767E\u6BEB\u79D2\u3002
            # \u9ED8\u8BA4 1000 \u6BEB\u79D2\uFF0C\u6700\u9AD8\u8BBE\u7F6E 2000\u8DB3\u77E3\u3002\u5982\u679C\u8D85\u65F6\uFF0C\u9996\u5148\u770B\u80FD\u4E0D\u80FD\u4F18\u5316\u63A5\u53E3\u76F8\u5173\u4E1A\u52A1\u3001SQL\u67E5\u8BE2\u7B49\uFF0C\u4E0D\u8981\u76F2\u76EE\u52A0\u5927\u8D85\u65F6\u65F6\u95F4\uFF0C\u5426\u5219\u4F1A\u5BFC\u81F4\u7EBF\u7A0B\u5806\u79EF\u8FC7\u591A\uFF0Chystrix \u7EBF\u7A0B\u6C60\u5361\u6B7B\uFF0C\u6700\u7EC8\u670D\u52A1\u4E0D\u53EF\u7528\u3002
            timeoutInMilliseconds: ${HYSTRIX_COMMAND_TIMEOUT_IN_MILLISECONDS:40000}

ribbon:
  # \u5BA2\u6237\u7AEF\u8BFB\u53D6\u8D85\u65F6\u65F6\u95F4\uFF0C\u8D85\u65F6\u65F6\u95F4\u8981\u5C0F\u4E8EHystrix\u7684\u8D85\u65F6\u65F6\u95F4\uFF0C\u5426\u5219\u91CD\u8BD5\u673A\u5236\u5C31\u65E0\u610F\u4E49\u4E86
  ReadTimeout: ${RIBBON_READ_TIMEOUT:30000}
  # \u5BA2\u6237\u7AEF\u8FDE\u63A5\u8D85\u65F6\u65F6\u95F4
  ConnectTimeout: ${RIBBON_CONNECT_TIMEOUT:3000}
  # \u8BBF\u95EE\u5B9E\u4F8B\u5931\u8D25(\u8D85\u65F6)\uFF0C\u5141\u8BB8\u81EA\u52A8\u91CD\u8BD5\uFF0C\u8BBE\u7F6E\u91CD\u8BD5\u6B21\u6570\uFF0C\u5931\u8D25\u540E\u4F1A\u66F4\u6362\u5B9E\u4F8B\u8BBF\u95EE\uFF0C\u8BF7\u4E00\u5B9A\u786E\u4FDD\u63A5\u53E3\u7684\u5E42\u7B49\u6027\uFF0C\u5426\u5219\u91CD\u8BD5\u53EF\u80FD\u5BFC\u81F4\u6570\u636E\u5F02\u5E38\u3002
  OkToRetryOnAllOperations: true
  MaxAutoRetries: 1
  MaxAutoRetriesNextServer: 1

mybatis:
  mapperLocations: classpath*:/mapper/*.xml
  configuration:
    mapUnderscoreToCamelCase: true

hzero:
  data:
    permission:
      db-owner: ${HZERO_DB_OWNER:}
  resource:
    # \u5339\u914D\u7684\u8D44\u6E90\u624D\u4F1A\u89E3\u6790JwtToken\u4FBF\u4E8E\u5F97\u5230UserDetails
    pattern: ${HZERO_RESOURCE_PATTERN:/v1/*,/hzero/*,/hmsg/v1/*,/hmsg/hzero/*}

logging:
  level:
    org.apache.ibatis: ${LOG_LEVEL:info}
    io.choerodon: ${LOG_LEVEL:info}
    org.hzero: ${LOG_LEVEL:info}
    org.hzero.boot.platform.lov: ${LOG_LEVEL:error}